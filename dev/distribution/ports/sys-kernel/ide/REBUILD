#
# kernel build script
#
%author: jfried
%package-group: sys-kernel -
%sub-group: ide -
%required: ("module-init-tools >=3.0")
%build-required: ("module-init-tools >=3.0")
%description: The Linoratix GNU/Linux Kernel
%name: kernel-linoratix-ide
%version: 2.6.7
%build: $DATA
%sourcefile: linux-2.6.7.tar.bz2
%source-url: ("http://download.linoratix.com/distfiles")
%provides: kernel

__DATA__
lip_extract %sourcefile
lip_cd %compile_dir
# 001 und 002 ist selinux und bootsplash
lip_other for patch in %patch_dir/*.patch; do patch -Np1 -i $patch; done
# -- execution of pre-install-scripts
lip_sed -e "s:EXTRAVERSION = -selinux1:EXTRAVERSION = -linoratix-ide:" Makefile > Makefile.p
lip_copy %compile_dir/Makefile.p %compile_dir/Makefile
lip_make clean
lip_get_file config %compile_dir/.config
lip_make oldconfig
lip_make
lip_make modules
lip_make modules_install INSTALL_MOD_PATH=%install_dir
lip_mkdir -p %install_dir/boot
lip_copy %compile_dir/arch/i386/boot/bzImage %install_dir/boot/bzImage-%version-%name
lip_copy %compile_dir/System.map %install_dir/boot
lip_mkdir %install_dir/usr/src -p
lip_cp -a %compile_dir %install_dir/usr/src
lip_ln -sf linux-2.6.7 %install_dir/usr/src/linux
#lip_rm /lib/modules/2.6.7-linoratix-ide/build
# -- execution of post-install-scritps
__DATA__

